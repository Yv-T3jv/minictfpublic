from sage.all import *
from Crypto.Util.number import long_to_bytes
n = 115792089210356248762697446949407573529996955224135760342422259061068512044369
d = 33164295574854248474909959606226799722938956633130941823192390535450727774589

r1 = 87407507200078255501956207165228079244628473573007060329786842206879062108699
s1 = 94782084345456252456002479253182884120883121946102228816179186306712053691036
h1 = 83052623219194200399729001413484981301296681742877161826022468513203600538135

r2 = 7045174940910533394198912282157915590858553633426718282563484504872444252529
s2 = 60877170991797456963428100713949950072759987147005088882599262721396061817860
h2 = 20455703239512472777331571165629051182261163089363633216947777034279995983359

K = pow(2, 100)
x = (s1 * r2) % n 
y = (-r1 * s2) % n 
z = ((h2 * r1) - (h1 * r2)) % n
mul = K
lattice = Matrix(ZZ, [
    [n * mul, 0, 0, 0],
    [x * mul, 1, 0, 0],
    [y * mul, 0, 1, 0],
    [z * mul, 0, 0, K]
]).LLL()
print(lattice)
r0 = lattice[0]
assert(r0[3] == K)
k2 = r0[2]
d = (pow(r2, -1, n) * (k2 * s2 - h2)) % n
d = int(d)
print(long_to_bytes(d))